var adobeDPS=function(){function u(){var a;this.BRIDGE_PREFIX_URI="bridge://";this.bridgeBusy=!0;this.bridgeMessageQueue=[];this.messageBuffer=[];this.totalSends=this.sendTime=this.sentData=0;this.metrics=[Infinity,-Infinity,0];this.metricsLogTimeout=null;this.location="adobeDPS._bridge";document.body!==null?(this.bridgeBusy=!1,this.out({event:{type:"BridgeInitialized",bridgeLocation:this.location}}),d.instance.info("BridgeInitialized - LOC: "+this.location)):(a=this,window.addEventListener("DOMContentLoaded",
    function(){a.handleDomLoaded.call(a)}))}function A(a,b){this.lvl=a;this.msg=b;this.timestamp=new Date}function d(){this.enableLogging=!0;this._profileTimers={};this._logList=[]}function B(){throw Error("Class object should never be directly constructed");}function ca(a,b,c,e,d){this._listener=b;this._isOnce=c;this.context=e;this._signal=a;this._priority=d||0}function k(){this._bindings=[];this._prevParams=null}function S(){if(!(this instanceof S))throw Error("TransactionError initialized without new keyword!");
    this.code=0}function h(){if(!(this instanceof h))throw Error("Transaction initialized without new keyword!");this.stateChangedSignal=new k;this.completedSignal=new k;this.progressSignal=new k;this.id=null;this.progress=this.state=0;this.error=new S;this.isDeterminate=this.isPausable=this.isCancelable=!1;this.isFailureTerminal=!0}function T(){h.call(this)}function U(){h.call(this)}function N(a,b){this.addedSubscriptions=a;this.removedSubscriptions=b;h.call(this)}function G(a){this.productId=a;h.call(this)}
    function H(a,b,c){if(!c&&(!a||!b))throw Error("A token or a username and password must be provided for a UserSigninTransaction");this.username=a;this.password=b;this.token=c;h.call(this)}function V(){h.call(this)}function n(){}function g(){this.newTransactionsAvailableSignal=new k;this._allTransactions={};this._lastUID=null;this._lastUIDCounter=0;this.transactionStates=r;this.transactionErrorTypes=l}function p(){this.updatedSignal=new k;this.id=null;this.currentTransactions=[];this.downloadSize=null;
        this.state=da.INVALID;this.title=this.previewImageURL=null;this.isUpdatable=this.isArchivable=this.isViewable=this.isDownloadable=this.isCompatible=!1}function q(){p.call(this);this.filter=this.broker=this.price=this.description=this.folioDescription=this.publicationDate=this.folioNumber=this.productId=null;this.isThirdPartyEntitled=!1;this.targetDimensions=null;this.supportsContentPreview=this.isPurchasable=!1;this.receipt=null;this.entitlementType=ea.UNKNOWN;this.hasSections=!1;this.contentPreviewState=
        fa.NOT_REQUESTED;this.sections=new W}function O(){p.call(this);this.parentFolio=null;this.isAtHeadOfDownloadQueue=!1;this.index=0}function W(){this.addedSignal=new k;this.removedSignal=new k;this.internal={}}function s(){this.updatedSignal=new k;this.folioMap=new W;this.folioStates=da;this.folioContentPreviewStates=fa;this.currentTransaction=null}function j(a){this.folio=a;h.call(this);this.completedSignal.add(this._completedHandler,this)}function v(a){j.call(this,a)}function I(a,b,c){this.broker=
        a;this.productId=b;this.token=c;this.isSubscription=!1}function t(a,b,c,e,d){this.updatedSignal=new k;this.productId=a;this.title=b;this.duration=c;this.price=e;this.isOwned=d||!1;this.receipt=null}function P(a,b,c,e,d){this.startDate=e;this.endDate=d;I.call(this,a,b,c);this.isSubscription=!0}function Q(){this.orientation=this.type=this.label=this.buttonDisabledImage=this.buttonDownImage=this.buttonUpImage=null}function J(a){j.call(this,a)}function X(a){j.call(this,a)}function C(a){j.call(this,a);
        this.step=0;this.isDeterminate=this.isCancelable=this.isPausable=!0;this.isFailureTerminal=!1}function K(a,b,c,e){this.isPortrait=b;this.width=c;this.height=e;this.previewImageURL=null;j.call(this,a)}function Y(a){j.call(this,a)}function Z(a){j.call(this,a)}function R(a){j.call(this,a);this.step=0;this.isDeterminate=this.isCancelable=this.isPausable=!0;this.isFailureTerminal=!1}function L(a){C.call(this,a)}function $(a){j.call(this,a)}function ga(){this.updatedSignal=new k}function F(){this.isEnabled=
        this.isSupported=!1;this.updatedSignal=new k}function m(){this.variables={}}function y(){this.updatedSignal=new k;this.userAuthenticationChangedSignal=new k;this.currentTransaction=null;this.isUserAuthenticated=!1;this.token=this.userName=null}function z(){this.applicationStates={};this.applicationStateTypes=ba;this.applicationVersion=this.applicationID=null}function w(){this.updatedSignal=new k;this.isCustomDialogDisplaying=!1}function D(){this.updatedSignal=new k;this.deviceName=this.os=this.deviceId=
        null;this.isOnline=this.isPurchasingEnabled=!1;this.networkType=null;this.networkTypes=ha;this.omnitureVisitorId=this.pushNotificationToken=null}function o(){this.newReceiptsAvailableSignal=new k;this.receipts={};this.subscriptionReceipts={};this.availableSubscriptions={};this.subscriptionsAddedSignal=new k;this.subscriptionsRemovedSignal=new k;this.entitlementTypes=ea}function E(){this.autoArchive=F.instance}function ia(a,b,c,e,d,g,h){this.latitude=a;this.longitude=b;this.accuracy=e;this.altitude=
        c!==void 0?c:null;this.heading=d!==void 0?d:null;this.speed=g!==void 0?g:null;if(this.speed===0||this.speed===null)this.heading=NaN;this.altitudeAccuracy=h!==void 0?h:null}function M(a,b){this.code=a||null;this.message=b||""}function ja(){this.enableHighAccuracy=!1;this.maximumAge=0;this.timeout=Infinity}function ka(a,b){return setTimeout(function(){var b=x.instance.callbacks[a];clearTimeout(b.timeout.timer);b.timeout.timer=null;b.fail&&b.fail({code:M.TIMEOUT,message:"Position retrieval timed out."})},
        b)}function x(){this.callbacks={};this.lastPosition=null}function i(){try{d.instance.enableLogging=!0,d.instance.debug("Interface initialized"),this.version=1.2,this.uid=this._generateUID(),this.initializationComplete=new k,this._bridge=u.instance,this.libraryService=s.instance,this.transactionManager=g.instance,this.authenticationService=y.instance,this.deviceService=D.instance,this.receiptService=o.instance,this.settingsService=E.instance,this.analyticsService=m.instance,this.configurationService=
        z.instance,this.dialogService=w.instance,this.geolocation=null,this.log=d.instance,this._bridge.out({event:{type:"LibraryAPIReady",version:this.version,id:this.uid}}),d.instance.info("LibraryAPIReady - V: "+this.version+", ID: "+this.uid)}catch(a){d.instance.error(a)}}u.prototype.handleDomLoaded=function(){this.bridgeBusy=!1;this.out({event:{type:"BridgeInitialized",bridgeLocation:this.location}});d.instance.info("BridgeInitialized - LOC: "+this.location)};u.prototype.out=function(a,b){var c,e;if(!this.bridgeBusy||
        b){this.bridgeBusy=!0;if(a instanceof Array){e="[";for(c=0;c<a.length;c++)e+=JSON.stringify(a[c])+(c<a.length-1?",":"");e+="]"}else e=JSON.stringify(a);this.sentData=e.length;this.sendTime=(new Date).getTime();this.totalSends++;window.location=this.BRIDGE_PREFIX_URI+encodeURIComponent(e);d.instance.bridge("OUT - "+e)}else this.bridgeMessageQueue.push(a)};u.prototype.partialInput=function(a,b,c,e){var f="";try{if(e===!0){if(this.messageBuffer[a]&&this.messageBuffer[a].length){for(e=0;e<b;++e)f+=this.messageBuffer[a][e];
        d.instance.bridge("EXECUTE ("+a+" [ "+b.toString()+" ]) - "+c);this.input(JSON.parse(f),c);this.messageBuffer[a].length=0}}else this.messageBuffer[a]||(this.messageBuffer[a]=[]),d.instance.bridge("APPEND ("+a+" [ "+b.toString()+" ]) - "+c.length.toString()),this.messageBuffer[a][b]=c}catch(g){d.instance.error(g)}};u.prototype.input=function(a,b){try{switch(d.instance.bridge("INPUT("+b+") - "+JSON.stringify(a)),b){case "_initialize":i.instance._initialize(a);break;case "_update":i.instance._update(a);
        break;default:d.instance.warn("Bridge.input received call for unknown endpoint: "+b)}}catch(c){d.instance.error(c)}};u.prototype.notifyReceivedBridgeData=function(){this.bridgeBusy=!1;this.updateMetrics();this.processQueue()};u.prototype.updateMetrics=function(){var a;a=this.sentData/1024/(((new Date).getTime()-this.sendTime)/1E3);this.metrics[0]>a&&(this.metrics[0]=a);this.metrics[1]<a&&(this.metrics[1]=a);this.metrics[2]=(this.metrics[2]*(this.totalSends-1)+a)/this.totalSends;this.logMetrics()};
    u.prototype.logMetrics=function(){this.metricsLogTimeout&&clearTimeout(this.metricsLogTimeout);var a=this;this.metricsLogTimeout=setTimeout(function(){a.totalSends=1;d.instance.info("Bridge BW - Min: "+a.metrics[0].toFixed(2)+"KB/s, Max: "+a.metrics[1].toFixed(2)+"KB/s, Avg: "+a.metrics[2].toFixed(2)+"KB/s")},1E3)};u.prototype.processQueue=function(){if(this.bridgeMessageQueue.length>0)this.out(this.bridgeMessageQueue),this.bridgeMessageQueue.length=0};u.instance=new u;d.prototype.error=function(a){if(this.enableLogging){var b=
        !1;try{a?this._logList.push(new A(this.logLevels.ERROR,a.message+"\n"+printStackTrace({e:a}).join("\n"))):this._logList.push(new A(this.logLevels.ERROR,a.message+"\n"+printStackTrace().join("\n"))),b=!0}catch(c){}finally{b||this._logList.push(new A(this.logLevels.ERROR,a.message))}}};d.prototype.warn=function(a){this.enableLogging&&this._logList.push(new A(this.logLevels.WARN,a))};d.prototype.info=function(a){this.enableLogging&&this._logList.push(new A(this.logLevels.INFO,a))};d.prototype.debug=
        function(a){this.enableLogging&&this._logList.push(new A(this.logLevels.DEBUG,a))};d.prototype.profile=function(a){if(this.enableLogging){var b;this._profileTimers.hasOwnProperty(a)?(b=Date.now()-this._profileTimers[a],this._logList.push(new A(this.logLevels.PROFILE,a+": "+b+"ms"))):this._profileTimers[a]=Date.now()}};d.prototype.bridge=function(a){this.enableLogging&&this._logList.push(new A(this.logLevels.BRIDGE,a))};d.prototype.print=function(a,b){if(this.enableLogging){var c,e,d="";for(c=0;c<
        this._logList.length;c++)e=this._logList[c],a&e.lvl&&(d+=this._lvlToStr(e.lvl),d+=b?" ["+e.timestamp.getTime()+"] ":" - ",d+=e.msg+"\n");return d}else return""};d.prototype.clear=function(){if(this.enableLogging)this._logList.length=0};d.prototype._lvlToStr=function(a){switch(a){case this.logLevels.BRIDGE:return"BRIDGE";case this.logLevels.DEBUG:return"DEBUG";case this.logLevels.PROFILE:return"PROFILE";case this.logLevels.INFO:return"INFO";case this.logLevels.WARN:return"WARN";case this.logLevels.ERROR:return"ERROR";
        default:return"LOG"}};d.instance=new d;d.prototype.logLevels={BRIDGE:1,DEBUG:2,PROFILE:4,INFO:8,WARN:16,ERROR:32};d.instance.profile("InitializationTime");B.prototype.toString=function(){var a=/(\w+)\(/.exec(this.constructor.toString())[1];this.hasOwnProperty("id")&&(a+="["+this.id+"]");return a};B.extend=function(a){var b,c;b=this.prototype;c=function(){};c.prototype=b;b=new c;a.prototype=b;a.prototype.constructor=a;a.extend=B.extend};ca.prototype={active:!0,params:null,execute:function(a){var b;
        this.active&&this._listener&&(a=this.params?this.params.concat(a):a,b=this._listener.apply(this.context!==void 0?this.context:window,a),this._isOnce&&this.detach());return b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal;delete this._listener;delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+
        this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};k.validateListener=function(a,b){if(typeof a!=="function")throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));};k.prototype={memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,e){var d=this._indexOfListener(a,c);if(d!==-1){if(a=this._bindings[d],a.isOnce()!==b)throw Error("You cannot add"+(b?"":"Once")+"() then add"+(!b?"":"Once")+"() the same listener without removing the relationship first.");
    }else a=new ca(this,a,b,c,e),this._addBinding(a);this.memorize&&this._prevParams&&a.execute(this._prevParams);return a},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c=this._bindings.length,e;c--;)if(e=this._bindings[c],e._listener===a&&e.context===b)return c;return-1},has:function(a,b){return this._indexOfListener(a,b)!==-1},add:function(a,b,c){k.validateListener(a,
        "add");return this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){k.validateListener(a,"addOnce");return this._registerListener(a,!0,b,c)},remove:function(a,b){k.validateListener(a,"remove");var c=this._indexOfListener(a,b);c!==-1&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=
        !1},dispatch:function(a){if(this.active){var b=Array.prototype.slice.call(arguments),c=this._bindings.length,e;if(this.memorize)this._prevParams=b;if(c){e=this._bindings.slice();this._shouldPropagate=!0;do c--;while(e[c]&&this._shouldPropagate&&e[c].execute(b)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var l=
    {TransactionCannotConnectToInternetError:-100,TransactionCannotConnectToServerError:-110,TransactionAuthenticationUnrecognizedCredentialsError:-150,TransactionFolioPurchasingDisabledError:-200,TransactionFolioCannotPurchaseError:-210,TransactionSubscriptionCannotPurchaseError:-220,TransactionSubscriptionResolveError:-225,TransactionRestorePurchasesError:-250,TransactionQuotaExceededError:-300,TransactionFolioIncompatibleError:-400,TransactionFolioNotEnoughDiskSpaceError:-500,TransactionFolioCannotDownloadError:-510,
        TransactionFolioFileMissingOrInvalid:-520,TransactionFolioCannotInstallItemError:-530,TransactionFolioNoPreviewAvailable:-540,TransactionInternalError:-900,toErrorType:function(a){switch(parseInt(a,10)){case -100:return l.TransactionCannotConnectToInternetError;case -110:return l.TransactionCannotConnectToServerError;case -150:return l.TransactionAuthenticationUnrecognizedCredentialsError;case -151:return l.TransactionAuthenticationCancelError;case -200:return l.TransactionFolioPurchasingDisabledError;
        case -210:return l.TransactionFolioCannotPurchaseError;case -211:return l.TransactionFolioPurchaseCancelError;case -220:return l.TransactionSubscriptionCannotPurchaseError;case -221:return l.TransactionSubscriptionPurchaseCancelError;case -225:return l.TransactionSubscriptionResolveError;case -250:return l.TransactionRestorePurchasesError;case -251:return l.TransactionRestorePurchaseCancelError;case -300:return l.TransactionQuotaExceededError;case -400:return l.TransactionFolioIncompatibleError;case -500:return l.TransactionFolioNotEnoughDiskSpaceError;
        case -510:return l.TransactionFolioCannotDownloadError;case -520:return l.TransactionFolioFileMissingOrInvalid;case -530:return l.TransactionFolioCannotInstallItemError;case -540:return l.TransactionFolioNoPreviewAvailable;case -900:return l.TransactionInternalError;default:throw Error("Invalid TransactionError: "+a);}}};B.extend(S);var r={FAILED:-100,CANCELED:-1,INITIALIZED:0,PAUSED:100,ACTIVE:200,FINISHED:400,toState:function(a){switch(parseInt(a,10)){case -100:return r.FAILED;case -1:return r.CANCELED;
        case 0:return r.INITIALIZED;case 100:return r.PAUSED;case 200:return r.ACTIVE;case 400:return r.FINISHED;default:throw Error("Invalid TransactionState: "+a);}}};B.extend(h);h.prototype.isFolioStateChangingTransaction=function(){return this instanceof v};h.prototype.start=function(){if(this.state!=r.INITIALIZED)throw Error("Attempting to start an ongoing Transaction! State: "+this.state);else return i.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"start"}}),
        this};h.prototype.pause=function(){if(this.isPausable)i.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"pause"}});else throw Error("Attempting to pause a non-pausable Transaction!");return this};h.prototype.resume=function(){if(this.state!=r.PAUSED)throw Error("Attempting to resume a non-paused Transaction! State: "+this.state);else i.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"resume"}});
        return this};h.prototype.cancel=function(){if(this.isCancelable)i.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"cancel"}});else throw Error("Attempting to cancel a non-cancelable Transaction!");return this};h.prototype._isSuspendable=function(){return!1};h.prototype._suspend=function(){if(this._isSuspendable())i.instance._send({action:"call",path:"transactionManager._allTransactions['"+this.id+"']",data:{method:"suspend"}});else throw Error("Attempting to suspend a non-suspendable Transaction!");
        return this};h.prototype.jsonClassName="Transaction";h.prototype._toJSON=function(){return{type:this.jsonClassName,id:this.id}};h.prototype._updateFromJSON=function(a){var b;if(this.id===null&&a.hasOwnProperty("id"))this.id=a.id;if(a.hasOwnProperty("error")&&(b=a.error,b!==null&&b.hasOwnProperty("code"))){this.error=new S;try{this.error.code=l.toErrorType(b.code),d.instance.warn(this.jsonClassName+" error: "+this.error.code)}catch(c){d.instance.error(c)}}if(a.hasOwnProperty("isCancelable"))this.isCancelable=
        a.isCancelable;if(a.hasOwnProperty("isPausable"))this.isPausable=a.isPausable;if(a.hasOwnProperty("isDeterminate"))this.isDeterminate=a.isDeterminate;if(a.hasOwnProperty("state")){b=this.state;try{b=r.toState(a.state)}catch(e){d.instance.error(e)}if(this.state!=b)this.state=b,this.stateChangedSignal.dispatch(this)}if(a.hasOwnProperty("progress")&&(a=Number(a.progress),this.progress!=a))this.progress=a,this.progressSignal.dispatch(this)};h.extend(T);T.prototype.jsonClassName="LibraryUpdateTransaction";
    h.extend(U);U.prototype.jsonClassName="RestorePurchasesTransaction";h.extend(N);N.prototype.jsonClassName="ModifySubscriptionsListTransaction";N.prototype._toJSON=function(){var a,b,c,e;b=h.prototype._toJSON.call(this);e=[];for(a=0;a<this.addedSubscriptions.length;a++)c=this.addedSubscriptions[a],e.push(c._toJSON());b.addedSubscriptions=e;b.removedSubscriptions=this.removedSubscriptions;return b};h.extend(G);G.prototype.jsonClassName="SubscribeTransaction";G.prototype._toJSON=function(){var a=h.prototype._toJSON.call(this);
        a.productId=this.productId;return a};G.prototype._updateFromJSON=function(a){h.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("productId"))this.productId=a.productId};h.extend(H);H.prototype.jsonClassName="UserSigninTransaction";H.prototype._toJSON=function(){var a=h.prototype._toJSON.call(this);a.username=this.username;a.password=this.password;a.token=this.token;return a};H.prototype._updateFromJSON=function(a){h.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("username"))this.username=
        a.username;if(a.hasOwnProperty("password"))this.password=a.password;if(a.hasOwnProperty("token"))this.token=a.token};h.extend(V);V.prototype.jsonClassName="UserSignoutTransaction";B.extend(n);n.prototype._getNextPathElement=function(a){var b=a.indexOf(".");return b>-1?a.substring(0,b):a};n.prototype._getChildPath=function(a){var b=a.indexOf(".");return b>-1?a.substring(b+1):""};n.prototype._initialize=function(){};n.prototype._update=function(){};n.extend(g);g.prototype.activeTransactions=function(){var a=
    {},b,c;for(b in this._allTransactions)c=this._allTransactions[b],c.state==h.ACTIVE&&(a[b]=this._allTransactions[b]);return a};g.prototype.allTransactions=function(){var a={},b;for(b in this._allTransactions)a[b]=this._allTransactions[b];return a};g.prototype._registerTransaction=function(a,b){if(!a.hasOwnProperty("id")||a.id===null)a.id=this._generateUID();this._allTransactions[a.id]=a;a.completedSignal.add(function(a){d.instance.debug("Transaction "+a.id+" completed");delete this._allTransactions[a.id]},
        this,-Infinity);this._didOriginateHere(a)&&!b&&(i.instance._send({action:"add",path:"transactionManager",data:a._toJSON()}),d.instance.debug("Registered transaction "+a.id+" with native app"));return a};g.prototype._didOriginateHere=function(a){a=a.id.split("-");return a.length>0&&a[0]==i.instance.uid?!0:!1};g.prototype._generateUID=function(){var a=i.instance.uid+"-",b=(new Date).getTime();return b!=this._lastUID?(this._lastUID=b,this._lastUIDCounter=0,a+b.toString()):(this._lastUIDCounter++,a+b.toString()+
        this._lastUIDCounter)};g.prototype._transactionVOProcess=function(a){var b=null;switch(a.type){case "DownloadTransaction":b=new C;break;case "ArchiveTransaction":b=new X;break;case "LibraryUpdateTransaction":b=new T;break;case "PreviewImageTransaction":b=new K;break;case "PurchaseTransaction":b=new Y;break;case "RestorePurchasesTransaction":b=new U;break;case "ModifySubscriptionsListTransaction":b=new N([],[]);break;case "SubscribeTransaction":b=new G;break;case "UserSigninTransaction":b=new H;break;
        case "UserSignoutTransaction":b=new V;break;case "ViewTransaction":b=new Z;break;case "UpdateTransaction":b=new R;break;case "CheckPreviewAvailabilityTransaction":b=new J;break;case "PreviewTransaction":b=new L;break;case "FolioSectionListUpdateTransaction":b=new $;break;default:d.instance.info("TransactionManager received unknown Transaction: "+a.type)}b!==null&&b._updateFromJSON(a);return b};g.prototype._update=function(a){var b,c,e;if(a.hasOwnProperty("add")){b=a.add;c=[];for(e=0;e<b.length;e++)a=
        this._transactionVOProcess(b[e]),a!==null&&(this._registerTransaction(a),c.push(a));c.length>0?(this.newTransactionsAvailableSignal.dispatch(c),d.instance.debug("TransactionManager._update added "+c.length+" transactions")):d.instance.warn("TransactionManager._update (add) called with add that didn't add any transactions")}else a.hasOwnProperty("remove")?(c=a.remove,(a=this._allTransactions[c])?(a.completedSignal.dispatch(a),d.instance.debug("TransactionManager._update removed "+a.id)):d.instance.warn("TransactionManager._update (remove) called with unknown Transaction: "+
        c)):a.hasOwnProperty("update")&&a.path.indexOf("_allTransactions")>-1?(b=a.update,c=a.path.indexOf("']"),c=a.path.substring(18,c),(a=this._allTransactions[c])?a._updateFromJSON(b):d.instance.warn("TransactionManager._update called with unknown Transaction: "+c)):d.instance.warn("TransactionManager._update (update) cannot parse update: "+JSON.stringify(a))};g.prototype._initialize=function(a){var b,c,e;if(a.hasOwnProperty("update")){if(a=a.update,a.hasOwnProperty("_allTransactions")){b=[];for(c=0;c<
        a._allTransactions.length;c++)e=a._allTransactions[c],e=this._transactionVOProcess(e),e!==null&&(b.push(e),this._registerTransaction(e,!0));b.length>0&&(d.instance.debug("TransactionManager._initialize registered "+b.length+" new Transactions"),this.newTransactionsAvailableSignal.dispatch(b))}}else d.instance.warn("TransactionManager._initialize called without update")};g.instance=new g;var da={INVALID:0,UNAVAILABLE:50,PURCHASABLE:100,PURCHASING:101,ENTITLED:200,DOWNLOADING:201,EXTRACTABLE:400,EXTRACTING:401,
        INSTALLED:1E3},fa={NOT_REQUESTED:0,REQUESTED:1,UNAVAILABLE:2,AVAILABLE:3,DISABLED:4};n.extend(p);p.prototype.download=function(){if(!this.isDownloadable)throw Error("Attempting to download a baseFolio that is not downloadable");if(!this.isCompatible)throw Error("Attempting to download an incompatible baseFolio.");var a=new C(this);if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new DownloadTransaction on "+this.id);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],
        b;}}else throw Error("There was a problem creating the DownloadTransaction.");};p.prototype.view=function(){if(!this.isViewable)throw Error("Attempting to view a baseFolio that is not viewable! You must check isViewable before attempting to view a baseFolio.");if(!this.isCompatible)throw Error("Attempting to view an incompatible baseFolio.");var a=new Z(this);if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new ViewTransaction on "+this.id);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],
        b;}}else throw Error("There was a problem creating the ViewTransaction.");};p.prototype.getPreviewImage=function(a,b,c){if(a=new K(this,c,a,b)){g.instance._registerTransaction(a);d.instance.debug("Starting new PreviewImageTransaction on "+this.id);try{return a.start()}catch(e){throw delete g.instance._allTransactions[a.id],e;}}else throw Error("There was a problem creating the PreviewImageTransaction.");};p.prototype.currentStateChangingTransaction=function(){var a,b;for(a=0;a<this.currentTransactions.length;a++)if(b=
        this.currentTransactions[a],b instanceof v)return b;return null};p.prototype._update=function(a){a.hasOwnProperty("update")?this._updateFromJSON(a.update):d.instance.warn("BaseFolio._update ("+this.id+") cannot parse update: "+a)};p.prototype._updateFromJSON=function(a){var b,c,e=[];for(b in a)b in this?(c=this._processPropertyUpdate(a[b],b),this[b]!=c&&(this[b]=c,e.push(b))):d.instance.warn("Found invalid property in baseFolio update: "+b+"-"+a[b]);e.length>0&&this.updatedSignal.dispatch(e)};p.prototype._processPropertyUpdate=
        function(a,b){var c=[],e,d,h;switch(b){case "currentTransactions":c=[];e=a.length;for(h=0;h<e;h++){if((d=g.instance._allTransactions[a[h]])&&d.folio!==this)d.folio=this;d&&c.push(d)}return c;default:return a}};p._fromJSON=function(a){var b=new p;b._updateFromJSON(a);return b};p.extend(q);q.prototype.verifyContentPreviewSupported=function(){var a,b;for(a=0;a<this.currentTransactions.length;a++)if(b=this.currentTransactions[a],b instanceof J)return b;if(a=new J(this)){g.instance._registerTransaction(a);
        d.instance.debug("Starting new ContentPreviewAvailabilityTransaction on "+this.id);try{return a.start()}catch(c){throw delete g.instance._allTransactions[a.id],c;}}else throw Error("There was a problem creating the ContentPreviewAvailabilityTransaction.");};q.prototype.canDownloadContentPreview=function(){return this.supportsContentPreview&&!this.hasSections&&this.isPurchasable&&this.isCompatible&&!this.isArchivable&&this.currentStateChangingTransaction()==null};q.prototype.downloadContentPreview=
        function(){if(!this.canDownloadContentPreview())throw Error("Attempting to preview a Folio that cannot be previewed! You must check canDownloadContentPreview() before attempting to preview a Folio.");var a=new L(this);if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new PreviewContentTransaction on "+this.id);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the PreviewContentTransaction.");};q.prototype.purchase=
        function(){if(!this.isPurchasable)throw Error("Attempting to purchase a folio that is not purchasable");if(!this.isCompatible)throw Error("Attempting to purchase an incompatible folio.");var a=new Y(this);if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new PurchaseTransaction on "+this.id);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the PurchaseTransaction.");};q.prototype.isFree=function(){return this.broker==
        "noChargeStore"};q.prototype.update=function(){if(!this.isUpdatable)throw Error("Attempting to update a Folio that is not updatable! You must check isUpdatable before attempting to update a Folio.");if(!this.isCompatible)throw Error("Attempting to update an incompatible Folio.");var a=new R(this);if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new UpdateTransaction on "+this.id);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the UpdateTransaction.");
    };q.prototype.archive=function(){if(!this.isArchivable)throw Error("Attempting to archive a Folio that is not archivable! You must always check isArchivable before attempting to archive a Folio.");if(!this.isCompatible)throw Error("Attempting to archive an incompatible Folio.");var a=new X(this);if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new ArchiveTransaction on "+this.id);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the ArchiveTransaction.");
    };q.prototype.getSections=function(){if(!this.hasSections)throw Error("Attempting to get sections on a folio that does not have sections");var a=new $(this);if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new FolioSectionListUpdateTransaction on "+this.id);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the FolioSectionListUpdateTransaction.");};q.prototype._processPropertyUpdate=function(a,b){var c,
        d,f;switch(b){case "publicationDate":return new Date(parseInt(a,10));case "sections":for(c=0;c<a.length;c++)if(d=a[c],d.type=="Section")delete d.type,f=O._fromJSON(d),f.parentFolio=this,this.sections.internal[d.id]=f;return this.sections;default:return p.prototype._processPropertyUpdate.call(this,a,b)}};q.prototype._update=function(a){var b,c,e,f;e=this._getNextPathElement(a.path);if(e.indexOf("sections")>-1&&(b=e.indexOf("']"),e=e.substring(10,b),e=this.sections.internal[e])){a.path=this._getChildPath(a.path);
        e._update(a);return}if(a.hasOwnProperty("update"))this._updateFromJSON(a.update);else if(a.hasOwnProperty("add")){a=a.add;b=[];for(f=0;f<a.length;f++)c=a[f],e=null,c.type=="Section"?(delete c.type,e=O._fromJSON(c)):d.instance.warn("Folio._update ("+this.id+") called with an invalid typed add: "+c.type),e!==null?(e.parentFolio=this,this.sections.internal[c.id]=e,b.push(e)):d.instance.warn("Folio._update ("+this.id+") failed to parse added folio: "+folioVO.id);b.length>0?(this.sections.addedSignal.dispatch(b),
        d.instance.debug("Folio._update ("+this.id+") added "+b.length+" sections")):d.instance.warn("Folio._update ("+this.id+") called with add that didn't add any sections")}else if(a.hasOwnProperty("remove")){a=a.remove;b=[];for(f=0;f<a.length;f++)e=this.sections.internal[a[f]],e!==null?(delete this.sections.internal[e.id],b.push(e)):d.instance.warn("Folio._update ("+this.id+") failed to parse removed section: "+a[f]);b.length>0?(this.sections.removedSignal.dispatch(b),d.instance.debug("Folio ("+this.id+
        ") removed "+b.length+" sections")):d.instance.warn("Folio._update ("+this.id+") called with remove that didn't remove any sections")}else d.instance.warn("Folio._update ("+this.id+") cannot parse update: "+a)};q._fromJSON=function(a){var b=new q;b._updateFromJSON(a);return b};p.extend(O);O._fromJSON=function(a){var b=new O;b._updateFromJSON(a);return b};W.prototype.sort=function(a){var b=[],c;for(c in this.internal)b.push(this.internal[c]);b.sort(a);return b};W.prototype.getByProductId=function(a){var b,
        c;for(b in this.internal)if(c=this.internal[b],c.productId==a)return c;d.instance.warn("Unknown productId requested: "+a);return null};n.extend(s);s.prototype.updateLibrary=function(){if(this.currentTransaction!==null)throw Error("Attempting to update when Library is already being updated.");var a=new T;if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new LibraryUpdateTransaction");try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the LibraryUpdateTransaction.");
    };s.prototype._initialize=function(a){var b,c;if(a.hasOwnProperty("update"))if(a=a.update,a.hasOwnProperty("folioMap")){for(b=0;b<a.folioMap.length;b++)c=a.folioMap[b],c.type=="Folio"&&(delete c.type,this.folioMap.internal[c.id]=q._fromJSON(c));d.instance.debug("LibraryService._initialize added "+a.folioMap.length+" folios")}else d.instance.warn("LibraryService._initialize called without a folioMap");else d.instance.warn("LibraryService._initialize called without an update element")};s.prototype._update=
        function(a){d.instance.debug("LibraryService._update called: "+JSON.stringify(a));var b,c,e,f;b=this._getNextPathElement(a.path);if(b.indexOf("folioMap")>-1&&(f=b.indexOf("']"),f=b.substring(10,f),f=this.folioMap.internal[f])){a.path=this._getChildPath(a.path);f._update(a);return}if(a.hasOwnProperty("add")){a=a.add;b=[];for(c=0;c<a.length;c++)e=a[c],f=null,e.type=="Folio"?(delete e.type,f=q._fromJSON(e)):d.instance.warn("LibraryService._update called with an invalid typed add: "+e.type),f!==null?
            (this.folioMap.internal[e.id]=f,b.push(f)):d.instance.warn("LibraryService._update failed to parse added folio: "+e.id);b.length>0?(this.folioMap.addedSignal.dispatch(b),d.instance.debug("LibraryService._update added "+b.length+" folios")):d.instance.warn("LibraryService._update called with add that didn't add any folios")}else if(a.hasOwnProperty("remove")){a=a.remove;b=[];for(c=0;c<a.length;c++)f=this.folioMap.internal[a[c]],f!==null?(delete this.folioMap.internal[f.id],b.push(f)):d.instance.warn("LibraryService._update failed to parse removed folio: "+
            a[c]);b.length>0?(this.folioMap.removedSignal.dispatch(b),d.instance.debug("Removed "+b.length+" folios")):d.instance.warn("LibraryService._update called with remove that didn't remove any folios")}else d.instance.warn("LibraryService._update cannot parse update: "+a)};s.instance=new s;h.extend(j);j.prototype.start=function(){this.folio.currentTransactions.indexOf(this)==-1&&(this.folio.currentTransactions.push(this),this.folio.updatedSignal.dispatch(["currentTransactions"]));return h.prototype.start.call(this)};
    j.prototype._completedHandler=function(a){var b;if(a.state==r.FINISHED||a.state==r.FAILED||a.state==r.CANCELED)b=a.folio.currentTransactions.indexOf(this),b>-1&&(a.folio.currentTransactions.splice(b,1),a.folio.updatedSignal.dispatch(["currentTransactions"]),d.instance.debug("Transaction "+this.id+" finished: "+this.state))};j.prototype.jsonClassName="FolioTransaction";j.prototype._toJSON=function(){var a=h.prototype._toJSON.call(this);a.folio=this.folio.id;return a};j.prototype._updateFromJSON=function(a){h.prototype._updateFromJSON.call(this,
        a);if(a.hasOwnProperty("folio")){var b;if(typeof s!="undefined")b=s.instance.folioMap.internal[a.folio];else if(typeof ReadingService!="undefined"&&ReadingService.instance.currentFolio.id==a.folio)b=ReadingService.instance.currentFolio;if(b)this.folio=b,b.currentTransactions.indexOf(this)==-1&&(b.currentTransactions.push(this),b.updatedSignal.dispatch(["currentTransactions"]))}};j.extend(v);j.prototype.jsonClassName="FolioStateChangingTransaction";v.prototype.start=function(){var a,b;for(a=0;a<this.folio.currentTransactions.length;a++)if(b=
        this.folio.currentTransactions[a],b!==this&&b instanceof v&&!b._isSuspendable())throw Error("Attempting to start a FolioStateChangingTransaction on a folio that already has another FolioStateChangingTransaction acting on it: "+b.id);return j.prototype.start.call(this)};var ea={UNKNOWN:0,FREE:1,SINGLE:2,SUBSCRIPTION:3,THIRD_PARTY:4,PROMOTIONAL:5};B.extend(I);t.prototype.jsonClassName="Subscription";t.prototype.purchase=function(){if(this.isActive())throw Error("Subscription "+this.productId+" has already been purchased.");
        var a=new G(this.productId);if(a){g.instance._registerTransaction(a);try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the SubscribeTransaction.");};t.prototype.isActive=function(){return this.isOwned&&this.receipt.contains(new Date)?!0:!1};t.prototype._toJSON=function(){return{type:this.jsonClassName,productId:this.productId,title:this.title,duration:this.duration,price:this.price,isOwned:this.isOwned}};t.prototype._updateFromJSON=
        function(a){var b=[],c;for(c in a)this.hasOwnProperty(c)?this[c]!=a[c]&&(this[c]=this._processPropertyUpdate(a[c],c),b.push(c)):d.instance.warn("Found invalid property in subscription update: "+c+"-"+a[c]);b.length>0&&this.updatedSignal.dispatch(b)};t.prototype._processPropertyUpdate=function(a){return a};t._fromJSON=function(a){var b=new t;b._updateFromJSON(a);return b};I.extend(P);P.prototype.contains=function(a){return a>=this.startDate&&a<=this.endDate?!0:!1};var ba={NATIVE:"builtin",WEBVIEW:"webview"};
    B.extend(Q);Q._fromJSON=function(a){var b=new Q;b.buttonUpImage=a.upImage;b.buttonDownImage=a.downImage;b.buttonDisabledImage=a.disabledImage;b.label=a.label;b.type=a.stateType;b.orientation=a.orientation;return b};Q.prototype.gotoState=function(){z.instance.gotoState(this.label)};j.extend(J);J.prototype._updateFromJSON=function(a){j.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("previewAvailable")&&this.folio.supportsContentPreview!=a.previewAvailable)this.folio.supportsContentPreview=
        a.previewAvailable,this.folio.updatedSignal.dispatch(["supportsContentPreview"])};J.prototype.jsonClassName="CheckPreviewAvailabilityTransaction";v.extend(X);X.prototype.jsonClassName="ArchiveTransaction";v.extend(C);C.prototype._updateFromJSON=function(a){if(a.hasOwnProperty("step"))this.step=a.step;v.prototype._updateFromJSON.call(this,a)};C.prototype.jsonClassName="DownloadTransaction";j.extend(K);K.prototype.jsonClassName="PreviewImageTransaction";K.prototype._toJSON=function(){var a=j.prototype._toJSON.call(this);
        a.isPortrait=this.isPortrait;a.width=this.width;a.height=this.height;return a};K.prototype._updateFromJSON=function(a){j.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("isPortrait"))this.isPortait=a.isPortrait;if(a.hasOwnProperty("width"))this.width=a.width;if(a.hasOwnProperty("height"))this.height=a.height;if(a.hasOwnProperty("previewImageURL"))this.previewImageURL=a.previewImageURL};v.extend(Y);Y.prototype.jsonClassName="PurchaseTransaction";j.extend(Z);Z.prototype.jsonClassName="ViewTransaction";
    v.extend(R);R.prototype._updateFromJSON=function(a){v.prototype._updateFromJSON.call(this,a);if(a.hasOwnProperty("step"))this.step=a.step};R.prototype.jsonClassName="UpdateTransaction";C.extend(L);L.prototype._isSuspendable=function(){return!0};L.prototype._updateFromJSON=function(a){C.prototype._updateFromJSON.call(this,a);if(this.error.code==l.TransactionFolioNoPreviewAvailable)this.folio.supportsContentPreview=!1,adobeDPS.log.debug("Transaction failed with error:TransactionFolioNoPreviewAvailable"),
        this.folio.updatedSignal.dispatch(["supportsContentPreview"])};L.prototype.jsonClassName="PreviewTransaction";j.extend($);$.prototype.jsonClassName="FolioSectionListUpdateTransaction";n.extend(ga);ga.extend(F);F.prototype.toggle=function(a){this.isSupported&&a!=this.isEnabled&&(d.instance.debug("Setting autoArchive to: "+a),i.instance._send({action:"call",path:"settingsService.autoArchive",data:{method:"toggle"}}))};F.prototype._update=function(a){var b;if(a.hasOwnProperty("update")){b=[];a=a.update;
        if(a.hasOwnProperty("isSupported"))this.isSupported=a.isSupported,b.push("isSupported");if(a.hasOwnProperty("isEnabled"))this.isEnabled=a.isEnabled,b.push("isEnabled");b.length>0&&this.updatedSignal.dispatch(b)}else d.instance.warn("AutoArchive._update cannot parse update: "+JSON.stringify(a))};F.prototype._initialize=function(a){this._update(a)};F.instance=new F;n.extend(m);m.ALLOWED_VARIABLES="stackId,screenId,stackTitle,overlayId,overlayType,isOnline,folioManifestId,isAdView,productId,entitlementCategory,purchasePrice,purchaseUnits,customVariable1,customVariable2,customVariable3,customVariable4,customVariable5".split(",");
    m.ALLOWED_EVENTS=["customEvent1","customEvent2","customEvent3","customEvent4","customEvent5"];m.PURCHASE_CATEGORIES={subscription:"subscription",single:"single",free:"free",external:"external"};m.prototype._variableAliases={stackIndex:"stackId",stackId:"stackId",screenIndex:"screenId",screenId:"screenId",adTitle:"stackTitle",articleTitle:"stackTitle",stackTitle:"stackTitle",overlayId:"overlayId",overlayType:"overlayType",isOnline:"isOnline",issueName:"folioManifestId",folioManifestId:"folioManifestId",
        isAdView:"isAdView",productId:"productId",entitlementCategory:"entitlementCategory",purchasePrice:"purchasePrice",purchaseUnits:"purchaseUnits",customVariable1:"customVariable1",customVariable2:"customVariable2",customVariable3:"customVariable3",customVariable4:"customVariable4",customVariable5:"customVariable5"};m.prototype._eventAliases={customEvent1:"customEvent1",customEvent2:"customEvent2",customEvent3:"customEvent3",customEvent4:"customEvent4",customEvent5:"customEvent5"};m.prototype.setCustomVariableAlias=
        function(a,b){if(m.ALLOWED_VARIABLES.indexOf(a)>-1)this._variableAliases[b]=a;else throw Error("AnalyticsService.setCustomVariableAlias called with invalid realName: "+a);};m.prototype.setCustomEventAlias=function(a,b){if(m.ALLOWED_EVENTS.indexOf(a)>-1)this._eventAliases[b]=a;else throw Error("AnalyticsService.setCustomEventAlias called with invalid realName:"+a);};m.prototype.trackPurchaseStart=function(a,b,c){c.entitlementCategory=a;c.productId=b;i.instance._send({action:"call",path:"analyticsService",
        data:{method:"trackPurchaseStart",event:{analyticsEvent:"kFolioPurchaseStartedAnalyticsEvent",analyticsEventName:"",variables:c}}})};m.prototype.trackPurchaseComplete=function(a,b,c,d,f){f.entitlementCategory=a;f.productId=b;f.purchasePrice=d;f.purchaseUnits=c;i.instance._send({action:"call",path:"analyticsService",data:{method:"trackPurchaseComplete",event:{analyticsEvent:"kFolioPurchaseCompletedAnalyticsEvent",analyticsEventName:"",variables:f}}})};m.prototype.trackCustomEvent=function(a,b){if(m.ALLOWED_EVENTS.indexOf(this._eventAliases[a])!=
        -1)i.instance._send({action:"call",path:"analyticsService",data:{method:"trackCustomEvent",event:{analyticsEvent:this._eventAliases[a],analyticsEventName:a,variables:b}}});else throw Error("AnalyticsService.trackCustomEvent called with invalid eventName: "+a);};m.instance=new m;n.extend(y);y.prototype.login=function(a,b,c){if(this.isUserAuthenticated)throw Error("Login failed. User is already authenticated.");else if(a=new H(a,b,c)){g.instance._registerTransaction(a);d.instance.debug("Starting new UserSigninTransaction");
        try{return a.start()}catch(e){throw delete g.instance._allTransactions[a.id],e;}}else throw Error("There was a problem creating the UserSigninTransaction.");};y.prototype.logout=function(){if(this.isUserAuthenticated){var a=new V;if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new UserSignoutTransaction");try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],b;}}else throw Error("There was a problem creating the UserSignoutTransaction.");}else throw Error("Logout failed. User is not authenticated.");
    };y.prototype._update=function(a){d.instance.debug("AuthenticationService.prototype._update called:"+JSON.stringify(a));if(a.hasOwnProperty("update")){var b,c,a=a.update;b=[];if(a.hasOwnProperty("currentTransaction")&&(c=g.instance._allTransactions[a.currentTransaction],this.currentTransaction!=c))this.currentTransaction=c,b.push("currentTransaction");if(a.hasOwnProperty("userName")&&this.userName!=a.userName)this.userName=a.userName,b.push("userName");if(a.hasOwnProperty("token")&&(d.instance.debug("old:"+
        this.token+" new:"+a.token),this.token!=a.token))this.token=a.token,b.push("token");if(a.hasOwnProperty("isUserAuthenticated")&&this.isUserAuthenticated!=a.isUserAuthenticated)this.isUserAuthenticated=a.isUserAuthenticated,this.userAuthenticationChangedSignal.dispatch(this.isUserAuthenticated),b.push("isUserAuthenticated");b.length>0&&this.updatedSignal.dispatch(b)}else d.instance.warn("AuthenticationService._update called without update")};y.prototype._initialize=function(a){this._update(a)};y.instance=
        new y;n.extend(z);z.prototype._initialize=function(a){var b;if(a.hasOwnProperty("update")){var c=a.update;if(c.hasOwnProperty("applicationID"))this.applicationID=c.applicationID;if(c.hasOwnProperty("applicationVersion"))this.applicationVersion=c.applicationVersion;if(c.hasOwnProperty("applicationStates"))for(a=0;a<c.applicationStates.length;a++)if(b=c.applicationStates[a],b.hasOwnProperty("type")&&b.type=="ApplicationState"&&(b=Q._fromJSON(b),b.type==ba.NATIVE||b.type==ba.WEBVIEW))this.applicationStates[b.label]=
        b}else d.instance.warn("ConfigurationService._initialize called without update")};z.prototype.gotoState=function(a){if(this.applicationStates.hasOwnProperty(a))i.instance._send({action:"call",path:"configurationService",data:this.applicationStates[a]});else throw Error("ConfigurationService.gotoState called with invalid state label: "+a);};z.instance=new z;n.extend(w);w.prototype._initialize=function(a){if(a.hasOwnProperty("update")){if(a=a.update,a.hasOwnProperty("isCustomDialogDisplaying"))this.isCustomDialogDisplaying=
        a.isCustomDialogDisplaying}else d.instance.warn("DialogService._initialize called without update")};w.prototype._update=function(a){if(a.hasOwnProperty("update")){var b=[],a=a.update;if(a.hasOwnProperty("isCustomDialogDisplaying")&&this.isCustomDialogDisplaying!=a.isCustomDialogDisplaying)this.isCustomDialogDisplaying=a.isCustomDialogDisplaying,b.push("isCustomDialogDisplaying");this.updatedSignal.dispatch(b)}else d.instance.warn("DialogService._update called without update")};w.prototype.displayCustomDialog=
        function(){if(this.isCustomDialogDisplaying)throw Error("displayCustomDialog called while a dialog is displaying!");i.instance._send({action:"call",path:"dialogService",data:{method:"displayCustomDialog"}})};w.prototype.dismissCustomDialog=function(){if(!this.isCustomDialogDisplaying)throw Error("dismissCustomDialog called but no dialog is displaying");i.instance._send({action:"call",path:"dialogService",data:{method:"dismissCustomDialog"}})};w.prototype.open=function(a){adobeDPS.log.info("DialogService.open "+
        a);a.toLowerCase().search(/^https{0,1}:\/\//)==-1?adobeDPS.log.error(Error("DialogService.open does not support relative URLs")):i.instance._send({action:"call",path:"dialogService",data:{method:"open",url:a}})};w.instance=new w;var ha={UNKNOWN:"unknown",WIFI:"wifi",MOBILE:"mobile"};n.extend(D);D.prototype._initialize=function(a){if(a.hasOwnProperty("update")){a=a.update;if(a.hasOwnProperty("deviceId"))this.deviceId=a.deviceId;if(a.hasOwnProperty("os"))this.os=a.os;if(a.hasOwnProperty("deviceName"))this.deviceName=
        a.deviceName;if(a.hasOwnProperty("isPurchasingEnabled"))this.isPurchasingEnabled=a.isPurchasingEnabled;if(a.hasOwnProperty("isOnline"))this.isOnline=a.isOnline;if(a.hasOwnProperty("networkType"))this.networkType=a.networkType;if(a.hasOwnProperty("pushNotificationToken"))this.pushNotificationToken=a.pushNotificationToken;if(a.hasOwnProperty("omnitureVisitorId"))this.omnitureVisitorId=a.omnitureVisitorId}else d.instance.warn("DeviceService._initialize called without update")};D.prototype._update=function(a){if(a.hasOwnProperty("update")){var b=
        [],a=a.update;if(a.hasOwnProperty("deviceId")&&this.deviceId!=a.deviceId)this.deviceId=a.deviceId,b.push("deviceId");if(a.hasOwnProperty("os")&&this.os!=a.os)this.os=a.os,b.push("os");if(a.hasOwnProperty("deviceName")&&this.deviceName!=a.deviceName)this.deviceName=a.deviceName,b.push("deviceName");if(a.hasOwnProperty("isPurchasingEnabled")&&this.isPurchasingEnabled!=a.isPurchasingEnabled)this.isPurchasingEnabled=a.isPurchasingEnabled,b.push("isPurchasingEnabled");if(a.hasOwnProperty("isOnline")&&
        this.isOnline!=a.isOnline)this.isOnline=a.isOnline,b.push("isOnline");if(a.hasOwnProperty("networkType")&&this.networkType!=a.networkType)this.networkType=a.networkType,b.push("networkType");if(a.hasOwnProperty("pushNotificationToken")&&this.pushNotificationToken!=a.pushNotificationToken)this.pushNotificationToken=a.pushNotificationToken,b.push("pushNotificationToken");if(a.hasOwnProperty("omnitureVisitorId")&&this.omnitureVisitorId!=a.omnitureVisitorId)this.omnitureVisitorId=a.omnitureVisitorId,
        b.push("omnitureVisitorId");this.updatedSignal.dispatch(b)}else d.instance.warn("DeviceService._update called without update")};D.instance=new D;n.extend(o);o.prototype.registerNewReceipt=function(a,b){var c;if(a instanceof P){if((c=this.availableSubscriptions[a.productId])&&(c.receipt===null||c.receipt.endDate<a.endDate))c.receipt=a,c.isOwned=!0;c=a.productId+a.startDate.getTime().toString();this.subscriptionReceipts.hasOwnProperty(c)||(this.subscriptionReceipts[c]=a,b||this.newReceiptsAvailableSignal.dispatch([a]))}else if(a instanceof
        I){if(c=s.instance.folioMap.getByProductId(a.productId))c.receipt=a;this.receipts.hasOwnProperty(a.productId)||(this.receipts[a.productId]=a,b||this.newReceiptsAvailableSignal.dispatch([a]))}else throw Error("ReceiptService.registerNewReceipt received invalid receipt");return a};o.prototype.restorePurchases=function(){var a=new U;if(a){g.instance._registerTransaction(a);d.instance.debug("Starting new RestorePurchasesTransaction");try{return a.start()}catch(b){throw delete g.instance._allTransactions[a.id],
        b;}}else throw Error("There was a problem creating the RestorePurchasesTransaction.");};o.prototype.addSubscription=function(a){if(toString.call(a)=="[object String]"&&a!="")return this.addSubscriptions([a]);else throw Error("ReceiptService.addSubscription received invalid product ID");};o.prototype.addSubscriptions=function(a){var b,c,d;if(a instanceof Array){c=[];for(b=0;b<a.length;b++)if(d=a[b],toString.call(d)=="[object String]"&&d!="")this.availableSubscriptions[d]==null&&c.push(new t(d,"","",
        "",!1));else throw Error("ReceiptService.addSubscriptions received invalid product ID");if(c.length>0)return this._createModifySubscriptionsListTransaction(c,[]);else throw Error("Tried to add subscription(s) that already existed");}else throw Error("ReceiptService.addSubscriptions received invalid input");};o.prototype.removeSubscription=function(a){if(toString.call(a)=="[object String]"&&a!="")return this.removeSubscriptions([a]);else throw Error("ReceiptService.removeSubscription received invalid product ID");
    };o.prototype.removeSubscriptions=function(a){var b,c,d;if(a instanceof Array){c=[];for(b=0;b<a.length;b++)if(d=a[b],toString.call(d)=="[object String]"&&d!="")d=this.availableSubscriptions[d],d!=null&&c.push(d.productId);else throw Error("ReceiptService.removeSubscriptions received invalid product ID");if(c.length>0)return this._createModifySubscriptionsListTransaction([],c);else throw Error("Tried to remove subscription(s) that did not exist");}else throw Error("ReceiptService.removeSubscriptions received invalid input");
    };o.prototype.setSubscription=function(a){if(toString.call(a)=="[object String]"&&a!="")return this.setSubscriptions([a]);else throw Error("ReceiptService.setSubscription received invalid product ID");};o.prototype.setSubscriptions=function(a){var b,c,d,f;if(a instanceof Array){c=[];for(b=0;b<a.length;b++)if(d=a[b],toString.call(d)=="[object String]"&&d!="")f=this.availableSubscriptions[d],f==null&&c.push(new t(d,"","","",!1));else throw Error("ReceiptService.setSubscriptions received invalid product ID");
        b=[];for(d in this.availableSubscriptions)a.indexOf(d)==-1&&b.push(d);return this._createModifySubscriptionsListTransaction(c,b)}else throw Error("ReceiptService.setSubscriptions received invalid input");};o.prototype._createModifySubscriptionsListTransaction=function(a,b){var c=new N(a,b);if(c){g.instance._registerTransaction(c);d.instance.debug("Starting new ModifySubscriptionsListTransaction");d.instance.debug("ADDING:"+JSON.stringify(a));d.instance.debug("REMOVING:"+JSON.stringify(b));try{return c.start()}catch(e){throw delete g.instance._allTransactions[c.id],
        e;}}else throw Error("There was a problem creating the ModifySubscriptionsListTransaction.");};o.prototype._initialize=function(a){var b,c,e,f;if(a.hasOwnProperty("update")){a=a.update;b=[];if(a.hasOwnProperty("receipts"))for(c in a.receipts)f=a.receipts[c],f=new I(f.broker,c,f.token),this.registerNewReceipt(f,!0),b.push(f);if(a.hasOwnProperty("availableSubscriptions"))for(c in a.availableSubscriptions)f=a.availableSubscriptions[c],this.availableSubscriptions[f.productId]=new t(c,f.title,f.duration,
        f.price,f.isOwned);if(a.hasOwnProperty("subscriptionReceipts"))for(e in a.subscriptionReceipts){f=a.subscriptionReceipts[e];c=e.split("+");c=c.length>0?c[0]:e;f=new P(f.broker,c,f.token,new Date(f.startDate),f.endDate===null?null:new Date(f.endDate));f.startDate.getTime();if((c=this.availableSubscriptions[f.productId])&&(c.receipt===null||c.receipt.endDate<f.endDate))c.receipt=f,c.isOwned=!0;this.registerNewReceipt(f,!0);b.push(f)}b.length>0&&(this.newReceiptsAvailableSignal.dispatch(b),d.instance.debug("ReceiptService._initialize added "+
        b.length+" receipts"))}else d.instance.warn("ReceiptService._initialize called without update")};o.prototype._update=function(a){var b,c,e,f,g;d.instance.debug("ReceiptService._update called: "+JSON.stringify(a));if(a.hasOwnProperty("add")){b=a.add;c=[];e=[];for(f=0;f<b.length;f++)if(g=b[f],g.type=="Receipt")g=new I(g.broker,g.productId,g.token),this.registerNewReceipt(g,!0),c.push(g);else if(g.type=="SubscriptionReceipt"){g=new P(g.broker,g.productId,g.token,new Date(g.startDate),g.endDate===null?
        null:new Date(g.endDate));g.startDate.getTime();if((a=this.availableSubscriptions[g.productId])&&(a.receipt===null||a.receipt.endDate<g.endDate))a.receipt=g,a.isOwned=!0;d.instance.debug("\nReceiptService updated with Subscription Receipt: "+JSON.stringify(g));this.registerNewReceipt(g,!0);c.push(g)}else g.type=="Subscription"?(a=new t(g.productId,g.title,g.duration,g.price,!1),this.availableSubscriptions[g.productId]=a,e.push(a)):d.instance.warn("ReceiptService called with unknown add: "+g.type);
        c.length>0&&(this.newReceiptsAvailableSignal.dispatch(c),d.instance.debug("ReceiptService._update added "+c.length+" receipts"));e.length>0&&(this.subscriptionsAddedSignal.dispatch(e),d.instance.debug("ReceiptService._update added "+e.length+" subscriptions"));c.length==0&&e.length==0&&d.instance.warn("ReceiptService._update called with an add that resulted in no new receipts or subscriptions")}else if(a.hasOwnProperty("remove")){c=a.remove;b=[];for(f=0;f<c.length;f++)a=this.availableSubscriptions[c[f]],
        a!==null?(delete this.availableSubscriptions[a.productId],b.push(a)):d.instance.warn("LibraryService._update failed to parse removed subscription: "+c[f]);b.length>0?(this.subscriptionsRemovedSignal.dispatch(b),d.instance.debug("Removed "+b.length+" subscriptions")):d.instance.warn("LibraryService._update called with remove that didn't remove any subscriptions")}else a.hasOwnProperty("update")&&a.path.indexOf("availableSubscriptions")>-1?(b=a.update,f=a.path.indexOf("']"),f=a.path.substring(24,f),
        (a=this.availableSubscriptions[f])?a._updateFromJSON(b):d.instance.warn("ReceiptService._update called with unknown Sub: "+f)):d.instance.warn("ReceiptService._update called without add")};o.instance=new o;n.extend(E);E.prototype._initialize=function(a){var b;if(a.hasOwnProperty("update"))for(b in a=a.update,a)d.instance.debug("Found "+b+" setting."),this.hasOwnProperty(b)?this[b]._initialize(a[b]):d.instance.warn("SettingsService._initialize called with unknown setting: "+b);else d.instance.warn("SettingsService._initialize called without update")};
    E.prototype._update=function(a){var b=this._getNextPathElement(a.path);a.path=this._getChildPath(a.path);switch(b){case "autoArchive":d.instance.debug("Initializing SettingsService.AutoArchive...");this.autoArchive._update(a);break;default:d.instance.warn("SettingsService._update called with an unknown destination: "+b)}};E.instance=new E;var la=function(a,b){this.coords=a;this.timestamp=b===void 0?new Date:b instanceof Date?b:new Date(b)};M.PERMISSION_DENIED=1;M.POSITION_UNAVAILABLE=2;M.TIMEOUT=
        3;var aa=Math.floor(Math.random()*2E9);n.extend(x);x.prototype._update=function(a){if(a.hasOwnProperty("update"))if(a=a.update,a.hasOwnProperty("status")){var b=this.callbacks[a.callbackId];clearTimeout(b.timeout.timer);if(a.status===1){if(b.timeout.timer){var c=new ia(a.latitude,a.longitude,a.altitude,a.accuracy,a.course,a.speed,a.altitudeAccuracy);this.lastPosition=c=new la(c,a.timestamp);b.success(c)}}else b.timeout.timer=null,b.fail&&(c=new M(a.errorCode,a.errorMessage),b.fail(c));delete this.callbacks[a.callbackId]}else d.instance.warn("GeolocationService._update called without status");
    else d.instance.warn("GeolocationService._update called without update")};x.prototype.getCurrentPosition=function(a,b,c){if(a===void 0||a===null)throw Error("Invalid success callback function!");var d=new ja;if(c){if(c.maximumAge!==void 0&&!isNaN(c.maximumAge)&&c.maximumAge>0)d.maximumAge=c.maximumAge;if(c.enableHighAccuracy!==void 0)d.enableHighAccuracy=c.enableHighAccuracy;if(c.timeout!==void 0&&!isNaN(c.timeout))d.timeout=c.timeout<0?0:c.timeout}c=d;d={timer:null};this.lastPosition&&c.maximumAge&&
        (new Date).getTime()-this.lastPosition.timestamp.getTime()<=c.maximumAge?a(this.lastPosition):c.timeout===0?b({code:M.TIMEOUT,message:"timeout value in PositionOptions set to 0 and no cached Position object available, or cached Position object's age exceeds provided PositionOptions' maximumAge parameter."}):(d.timer=c.timeout!==Infinity?ka(aa,c.timeout):!0,this.callbacks[aa]={success:a,fail:b,timeout:d},i.instance._send({action:"call",path:"geolocationService",data:{method:"getCurrentPosition",callbackId:aa,
        highAccuracy:c&&c.enableHighAccuracy!==void 0?c.enableHighAccuracy:!1,maximumAge:c.maximumAge}}),aa++)};x.prototype.watchPosition=function(){throw Error("geolocation.watchPosition API is currently not supported!");};x.prototype.clearWatch=function(){throw Error("geolocation.clearWatch API is currently not supported!");};x.instance=new x;n.extend(i);i.prototype._generateUID=function(){return Math.floor(Math.random()*1E4).toString()+(new Date).getTime().toString()};i.prototype._initialize=function(a){var b,
        c,e;try{d.instance.debug("Interface._initialize called");(!a.hasOwnProperty("length")||a.length<=0)&&d.instance.warn("Interface._initialize called with no data");for(b=0;b<a.length;b++)if(c=a[b],c.hasOwnProperty("path"))switch(e=this._getNextPathElement(c.path),c.path=this._getChildPath(c.path),e){case "libraryService":d.instance.debug("Initializing libraryService...");s.instance._initialize(c);break;case "transactionManager":d.instance.debug("Initializing transactionManager...");g.instance._initialize(c);
        break;case "authenticationService":d.instance.debug("Initializing authenticationService...");y.instance._initialize(c);break;case "configurationService":d.instance.debug("Initializing configurationService...");z.instance._initialize(c);break;case "deviceService":d.instance.debug("Initializing deviceService...");D.instance._initialize(c);break;case "receiptService":d.instance.debug("Initializing receiptService...");o.instance._initialize(c);break;case "settingsService":d.instance.debug("Initializing settingsService...");
        E.instance._initialize(c);break;case "analyticsService":d.instance.debug("Initializing analyticsService...");m.instance._initialize(c);break;case "dialogService":d.instance.debug("Initializing dialogService...");w.instance._initialize(c);break;case "geolocationService":d.instance.debug("Initializing geolocationService...");this.geolocation=x.instance;x.instance._initialize(c);break;default:d.instance.warn("Interface._initialize called with an unknown destination: "+e)}else d.instance.warn("Interface._initialize received update without path: "+
        JSON.stringify(c));d.instance.profile("InitializationTime");this.initializationComplete.dispatch();d.instance.info("Initialization complete")}catch(f){d.instance.error(f)}};i.prototype._update=function(a){var b,c,e;try{for(b=0;b<a.length;b++)if(c=a[b],c.hasOwnProperty("path"))switch(e=this._getNextPathElement(c.path),c.path=this._getChildPath(c.path),e){case "libraryService":s.instance._update(c);break;case "transactionManager":g.instance._update(c);break;case "authenticationService":y.instance._update(c);
        break;case "configurationService":z.instance._update(c);break;case "deviceService":D.instance._update(c);break;case "receiptService":o.instance._update(c);break;case "settingsService":E.instance._update(c);break;case "analyticsService":m.instance._update(c);break;case "dialogService":w.instance._update(c);break;case "geolocationService":x.instance._update(c);break;default:d.instance.warn("Interface._update called with an unknown destination: "+e)}else d.instance.warn("Interface._update received update without path: "+
        JSON.stringify(c))}catch(f){d.instance.error(f)}};i.prototype._send=function(a){try{this._bridge.out({event:{type:"LibraryAPIActions",actions:[a]}})}catch(b){d.instance.error(b)}};i.instance=new i;return i.instance}();
